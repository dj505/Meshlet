<!DOCTYPE html>

<html>
    <head>
        <title>Meshlet v2 | 5panel.dance</title>
        <link type="text/css" rel="stylesheet" href="/stylesheets/main.css" />
        <link type="text/css" rel="stylesheet" href="/stylesheets/labels.css" />
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet" />
        <meta property="og:title" content="Meshlet" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="http://5panel.dance" />
        <meta property="og:image" content="https://dj505.github.io/assets/logo.jpg" />
        <meta property="og:description" content="A Compact & Versatile RP2350 Mesh Network Node" />
        <meta name="theme-color" content="#61afef" />
        <meta name="viewport" content="width=device-width, initial-scale=0.5" />
        <script type="text/javascript" src="/script/incl-html.js"></script>
    </head>

    <body>
        <div class="back-to-top">
            Quick Index<br/><br/>
            <a href="#top">Back to Top</a><br/>
            <a href="#what-is">What is it?</a><br/>
            <a href="#assembly">Assembly</a><br/>
            <a href="#firmware">Firmware</a><br/>
            <a href="#use-notes">Usage</a><br/>
            <a href="#source">Source</a><br/>
        </div>

        <div class="content" id="top">
            <a href="https://5panel.dance">
                <h1 align="center" class="topper-h1">5panel.dance</h1>
            </a>
            <h2 align="center">↙️↖️⏺️↗️↘️</h2>

            <p align="center"><a href="https://github.com/dj505">GitHub</a> • <a href="https://youtube.com/dj505itg">YouTube</a> • <a href="https://bsky.app/profile/5panel.dance">BlueSky</a> • <a href="https://discord.com/invite/ctMByBy">Discord</a> • <a href="https://ko-fi.com/dj505piu">Ko-Fi</a></p>

            <br/>

            <div class="info">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    Info
                </h2>
                <dl>
                    <dt>Meshlet is a work in progress!</dt>
                    <dd>The board has been tested and working short-term, but has not yet undergone extensive testing in the field. Keep an eye out here for updates!</dd>
                </dl>
            </div>

            <br/>

            <div class="grid">
                <div class="col">
                    <img src="assets/1.png" width="200px">
                </div>
                <div class="col">
                    <img src="assets/2.png" width="200px">
                </div>
            </div>

            <div id="what-is">
                <h2 class="body-header">What is it?</h2>
                <span class="body-text">
                    <p>
                        Meshlet is a LoRa mesh network node, designed to be compatible with the <em>Meshtastic®</em> project.
                        It's made to be deployed just about anywhere you want it to be - you can plug in a solar panel and set it up outside, turn it into a pocketable every-day-carry node, wire it up to your car as a mobile repeater, or even just leave it on a windowsill attached to a BBS script/Meshsense/etc.
                    </p>
                    <p>
                        Features include, but are not limited to...
                    </p>
                    <ul>
                        <li>USB C, with configurable charge rate limit (250mA, 500mA, 1A)</li>
                        <li>LiPo/LiIon and LiFePo4 support</li>
                        <li>ESD/TVS protection on the USB port</li>
                        <li>Solar input (as well as constant DC input) from 3.3V to 18V, tolerant up to 25V</li>
                        <ul>
                            <li>Flexible wiring methods, with dedicated JST PH footprints as well as pads to directly solder wires to!</li>
                            <li>Tested & working with as little as a cheap 80mm 5v solar panel, on an overcast Canadian winter day!</li>
                            <li>Unlike many boards that need a manual reset after too little sunlight drains the battery, the Meshlet should recover on its own!</li>
                        </ul>
                        <li>Smart power path management, thanks to the BQ25185. No need to worry about unnecessarily cycling the battery!</li>
                        <li>JST 2.0 and Picoblade 1.5mm battery connector footprints, to hopefully fit whatever LiPos you've got laying around</li>
                        <li>Low operating power, measuring as low as 2.8mA idle current draw (without WiFi)</li>
                        <li>Active current/voltage monitoring and reporting on 3 channels over the mesh, via INA3221</li>
                        <ul>
                            <li>Ch. 1: Battery</li>
                            <li>Ch. 2: USB & external power</li>
                            <li>Ch. 3: BQ25185 regulated battery output</li>
                        </ul>
                        <li>Up to 8MB onboard flash</li>
                        <li>WIO-SX1262 LoRa radio</li>
                        <li>BME280 temperature/humidity/barometric pressure sensor</li>
                        <li>I2C expansion port</li>
                        <li>Dedicated 3.3V regulators for all major components, each with its own self-resetting fuse, to ensure stable power</li>
                        <li>"External notification" header for a MOSFET-driven 3.3V buzzer, LED, vibration motor, etc</li>
                        <li>Raspberry Pi RM2 for optional WiFi (and Bluetooth, whenever the firmware supports it)</li>
                        <li>Total footprint size of ~42*32mm, less than half the size of a credit card!</li>
                    </ul>
                </span>
            </div>

            <div id="assembly">
                <h2 class="body-header">Assembly</h2>
                <span class="body-text">
                    <p>
                        Please see the <a href="assets/ibom.html" target="_blank">interactive BOM!</a> Included is a list of LCSC part numbers for the specific components used, for your convenience.
                    </p>
                    <p>
                        This board was partially designed with the intention of fitting those really cheap little hot plates you can get on AliExpress.
                        To save on costs, unless you're buying a prebuilt unit from me somehow, it is feasible to order the PCBs along with a stencil and using one of these hot plates. However, I would only recommend doing this if you're experienced with it!
                        The cost of the hot plate is roughly equivalent to what you'd spend on PCBA "extended component" fees from JLC anyway, and you can keep reusing it! Just make sure you have a suitable USB C power source for it.
                    </p>
                    <p>
                        <strong>Any parts <em>not</em> specifically listed as being optional for specific use cases are considered necessary!</strong><br />
                        If there are specific features you do or don't need, see the following modifications. <strong>This also includes parts that MUST be left out if another part is chosen</strong>, i.e. specific battery connectors.
                    </p>
                    <h3>No WiFi/Bluetooth</h3>
                    <p>
                        If you don't need WiFi or Bluetooth, you can leave out:
                        <ul>
                            <li><strong>U10</strong>: Raspberry Pi RM2</li>
                            <li><strong>R25</strong>: 470Ω 0402 resistor</li>
                            <li><strong>R28</strong>: 10kΩ 0402 resistor</li>
                            <li><strong>C32</strong>: 47μF 0402 ceramic capacitor</li>
                        </ul>
                    </p>
                    <h3>No BME280</h3>
                    <p>
                        If you don't need temperature/humidity or other environmental metrics, you can leave out:
                        <ul>
                            <li><strong>U7</strong>: BME280</li>
                            <li><strong>C22</strong>: 100nF 0402 ceramic capacitor</li>
                            <li><strong>C23</strong>: 100nF 0402 ceramic capacitor</li>
                        </ul>
                    </p>
                    <h3>JST 2.0mm vs. Picoblade 1.25mm Battery Connector</h3>
                    <p>
                        There are two options for battery connectors, both on the same physical space on the board.<br />
                        If you don't wish to use a battery, both of these can be ignored. If you do, <strong>you MUST pick at least <em>one</em> out of the following:</strong>
                        <ul>
                            <li><strong>J3</strong>: Molex Picoblade 1.25mm connector (often conflated with "JST 1.25mm" connectors in 3rd party listings)</li>
                            <li><strong>J4</strong>: JST-PH 2.0mm connector</li>
                        </ul>
                    </p>
                    <h3>No Solar/Ext. Connector</h3>
                    <p>
                        If you wish to solder external power wires from your preferred source directly to the pins on the back of the board, or only use USB input, you can leave out:
                        <ul>
                            <li><strong>J7</strong>: JST-PH 2.0mm connector (located on top, beside the USB port)</li>
                        </ul>
                    </p>
                    <h3>No LEDs</h3>
                    <p>
                        If you don't need any specific LED indicators, you can leave out any of the following:
                        <ul>
                            <li><strong>D3</strong>: 0603 SMD LED - heartbeat indicator</li>
                            <li><strong>D4</strong>: 0603 SMD LED - power indicator</li>
                            <li><strong>D5</strong>: 0603 SMD LED - charge indicator</li>
                            <li><strong>D6</strong>: 0603 SMD LED - power/battery fault indicator</li>
                        </ul>
                    </p>
                    <h3>Recommended LED Colours</h3>
                    <p>
                        These are the colours I recommend using for each indicator LED. These can be whatever you want, but consider adjusting the resistor values for each depending on the colour(s) you choose:
                        <ul>
                            <li><strong>D3</strong>: heartbeat indicator, recommended <span class="label-red">RED</span></li>
                            <li><strong>D4</strong>: power indicator, recommended <span class="label-green">GREEN</span></li>
                            <li><strong>D5</strong>: charge indicator, recommended <span class="label-blue">BLUE</span></li>
                            <li><strong>D6</strong>: power/battery fault indicator, recommended <span class="label-red">RED</span></li>
                        </ul>
                        By default, the resistor values for these are quite high, and they're difficult to see in bright conditions. This was done to save on energy while still allowing me to debug the boards indoors. You may wish to make them brighter, or dimmer.
                        Green and red lights will need weaker resistors than blue lights to resemble the same brightness.
                    </p>
                </span>
            </div>

            <div id="firmware">
                <h2 class="body-header">Firmware</h2>
                <span class="body-text">
                    <p>
                        My fork of the Meshtastic® firmware isn't available yet, as changes to the PCB routing between revisions likely means breaking compatibility with existing boards.
                        Once the design is close enough to "finished" for my liking and has proven to be reliable, I'll publish the fork! Watch this space for updates :)
                    </p>
                </span>
            </div>

            <div id="use-notes">
                <h2 class="body-header">Usage</h2>
                <span class="body-text">
                    <h3>General Notes</h3>
                    <p>
                        There are a few things I think you should keep in mind when using Meshlet:
                    </p>
                    <ul>
                        <li><strong>The BQ2185 only supports 1 cell in series!!!</strong> You can connect multiple in parallel if you know what you're doing, but please be safe and do your research!</li>
                        <li>The board is configured for LiPo/LiIon batteries by default. LiFePO4 batteries are supported, but you <strong>must</strong> flip the board over, cut the jumper in the lower left corner, and bridge the "LiFePO4" side (on the left) with some solder first!</li>
                        <li>There are some power test points for attaching extra expansion thingies if you can't power them through the I2C pads. I think the USB and 3V3 are obvious, but the "BMS" pin is the regulated output from the BQ25185 and will never exceed 4.5V. Good for hooking up to another regulator, if you need to.</li>
                        <li>The configurable charge rate very strongly depends on your use case. It is configured at 500mA by default, which should be enough for just about all use cases. <strong>You will need to lower this if you're using a battery smaller than 500mAh to avoid starting a fire!</strong></li>
                        <li>You have the option to attach a 10k NTC thermistor. This will cut off charging above/below certain temperatures. To use it, cut the "NTC" jumper on the front of the board, and solder it to the "THERMISTOR" through-hole connector.</li>
                        <li>The solar charging is based on the BQ25185's capabilities and is not a "true" MPPT. You will have the best results with 5-7V panels.</li>
                        <li>The RP2350, even when downclocked, still consumes more power than an nRF52. It's not nearly as bad as the ESP32, though, and I've been able to achieve roughly 3mA average power draw with no WiFi module attached. That's a good amount of runtime!</li>
                        <li>WiFi and Bluetooth capabilities depend on whether you can get your hands on the Raspberry Pi Radio Module 2 (RMC20452T). Currently, the firmware only supports WiFi.</li>
                        <li>The on-board power switch originally present has been removed from version 2, as it's more than adequate to simply wire a switch in series with the board's power supply. Please make sure that you select a suitable switch for the task!</li>
                    </ul>
                    <h3>App Configuration</h3>
                    <p>
                        For the board to work properly, you will need to adjust some settings within the app. Many of these should work out-of-the-box with the right firmware, but are included here in case they don't.
                    </p>
                    <ul>
                        <li><strong>Device</strong>:</li>
                        <ul>
                            <li><strong>Button GPIO</strong>: 17 (only set if it doesn't work by default!)</li>
                            <li><strong>Buzzer GPIO</strong>: 22</li>
                        </ul>
                        <li><strong>Power</strong>: Battery INA_2XX i2c address = 0x42 (or 66)</li>
                        <li><strong>External Notification</strong> (if desired):</li>
                        <ul>
                            <li><strong>External notification enabled</strong>: ON</li>
                            <li><strong>Alert message LED/Buzzer/Vibra</strong> (pick 1): ON</li>
                            <li><strong>Alert bell LED/Buzzer/Vibra</strong> (pick 1): ON</li>
                            <li><strong>Output LED/Buzzer/Vibra</strong> (pick 1): 22</li>
                            <li><strong>Output LED active high</strong>: ON</li>
                        </ul>
                        <li><strong>Telemetry</strong> (if desired):</li>
                        <ul>
                            <li><strong>Send Device Telemetry</strong>: ON</li>
                            <li><strong>Environment metrics module</strong>: ON only if BME280 is present</li>
                            <li><strong>Air quality metrics module</strong>: ON only if BME280 is present</li>
                            <li><strong>Power metrics module</strong>: ON</li>
                        </ul>
                    </ul>
                    <h3>Monitored Power Channels</h3>
                    <p>
                        There are three monitored power channels on the INA3221, the values for which can be displayed and broadcast over the mesh when power telemetry is enabled. The channels are as follows:
                    </p>
                    <ul>
                        <li><strong>Ch. 1</strong>: Battery voltage. Negative current value = discharging, positive current value = charging.
                        <li><strong>Ch. 2</strong>: External power input. Shared between USB power and the two solar/ext connectors. Useful to see if your solar panel is working as it should!
                        <li><strong>Ch. 3</strong>: Regulated BQ25185 load output. This monitors the power draw from everything after the battery chip, including the microcontroller, LoRa radio, WiFi module, and any other peripherals attached.
                    </ul>
                </span>
            </div>

            <div id="source">
                <h2 class="body-header">Source</h2>
                <span class="body-text">
                    <p>
                        <a href="https://github.com/dj505/meshlet"><span class="attn-label">KiCAD Project</span></a>
                    </p>
                    <p>
                        Meshlet is (and always will be) open source! All of the KiCAD project files are readily available, and so will the firmware changes, as soon as the board is finished and properly tested.
                    </p>
                </span>
            </div>
        </div>

        <footer>
            <div id="footer" incl-html="/include/footer.html"></div>
        </footer>

        <script>
            includeHTML();
        </script>
    </body>

</html>
